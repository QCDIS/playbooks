- hosts: localhost
  vars:
      ansible_python_interpreter: /usr/bin/python3

  tasks:
    - file:
        path: /var/lib/awx/.azure/
        state: directory

    - ini_file:
        path: /var/lib/awx/.azure/credentials
        section: default
        option: "{{item.option}}"
        value: "{{item.value}}"
      with_items:
        - { option: client_id, value: "{{ hostvars['localhost']['user'] }}" }
        - { option: tenant_id, value: "{{ hostvars['localhost']['extra_properties']['tenant'] }}" }
        - { option: subscription_id, value: "{{ hostvars['localhost']['extra_properties']['subscription_id'] }}" }
        - { secret: subscription_id, value: "{{ hostvars['localhost']['token'] }}" }


    - debug: msg="the value of foo.txt is {{lookup('file', '/var/lib/awx/.azure/credentials') }}"